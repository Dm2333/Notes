
OpenSSH: Information-leak vulnerability (CVE-2016-0777) 

Openssh 信息泄漏漏洞 (CVE-2016-0777)

OpenSSH: Client Information leak from use of roaming connection feature (CVE-2016-0777)

OpenSSH: 因使用漫游连接工难导致的客户端信息泄露

Since version 5.4, the OpenSSH client supports an undocumented feature called roaming. If a connection to an SSH server breaks unexpectedly, and if the SSH server supports roaming as well, the client is able to reconnect to the server and resume the interrupted SSH session. The roaming feature is enabled by default in OpenSSH clients, even though no OpenSSH server version implements the roaming feature.

5.4版本后, OpenSSL客户端支持一个尚未被文档化的叫做漫游 (Roaming) 的功能. 假如一个到SSH服务器的连接无端崩溃同时这个SSH服务器支持roaming功能, 客户端可以重连至服务器并恢复中断SSH会话. 尽管没有任何服务端版本支持该特性, 该漫游功能在OpenSSH客户端仍是默认开启的.

An information leak flaw was found in the way OpenSSH client roaming feature was implemented. The information leak is exploitable in the default configuration of certain versions of the OpenSSH client and could (depending on the client's version, compiler, and operating system) allow a malicious SSH server to steal the client's private keys.

在OpenSSH客户端的实现中发现了一个信息泄露漏洞. 当使用某些特定版本客户端的默认配置时, 这个漏洞可能 (取决于客户端的版本, 编译器以及操作系统) 导致恶意SSH服务器偷走客户端的私钥.

This issue has been assigned CVE-2016-0777, and was rated as having Moderate impact by Red Hat Product Security.

这个问题被定义为 CVE-2016-0777, 同时被红帽产品安全组评为具有中度影响.

Note that this flaw can only be triggered after successful authentication and therefore can only be exploited by a malicious or compromised SSH server. Man-in-the-middle (MITM) attackers can not exploit this issue.

值得注意的是只有成功认证之后这个漏洞才会被出发. 因此只可能会被恶意或受损的SSH服务器所利用. 中间人攻击无法利用该漏洞.

Affected Products

    Red Hat Enterprise Linux 4, 5, and 6 are not affected by this flaw because they include OpenSSH versions older than 5.4, and hence do not implement the roaming feature.
    Red Hat Enterprise Linux 7 since version 7.1 has provided OpenSSH 6.6 for which the default configuration is not affected by this flaw. OpenSSH 6.6 is only vulnerable to this issue when used with certain non-default ProxyCommand settings. Security update RHSA-2016-0043 corrects this issue.
    Red Hat Enterprise Linux 7 prior to version 7.1 (released in March 2015) provides OpenSSH 6.4 and is impacted regardless of the use of the ProxyCommand settings. The OpenSSH packages were updated from version 6.4 to version 6.6 in Red Hat Enterprise Linux 7.1 via RHSA-2015:0425.


受影响的产品

RHEL 4, 5, 6因为自带的OpenSSH版本低于5.4, 不支持漫游功能
RHEL 7中7.1之后的版本提供了OpenSSH 6.6版本. 这个版本的默认配置并不会收到该漏洞影响, 而当它使用非默认配置中的ProxyCommand设置时, 才会受此漏洞影响. RHSA-2016-0043修复了该问题.
RHEL 7中7.1之前的版本提供的是OpenSSH 6.4. 这个版本无论是否使用ProxyCommand设置, 都收到了该漏洞影响. RHSA-2015:0425能够将RHSA 7.1中的OpenSSH从6.4版本升级到6.6版本.

Mitigation:

In Red Hat Enterprise Linux 7 you can mitigate this issue by setting the following option in the OpenSSH client's configuration file, either global (/etc/ssh/ssh_config) or user specific (~/.ssh/config):

止损:

在RHEL 7中, 可以通过在OpenSSH客户端的配置文件 (全局配置文件 (/etc/ssh/ssh_config) 或是用户特定配置文件 (~/.ssh/config) 都行) 中进行以下选项的设置来止损:

    UseRoaming no

上述的指令应该写入配置文件中`Host *`选区里以便所有连接到的SSH服务器都使用这一设置.

你也可以在连接到SSH服务器时通过命令行参数来设置这一选项

    -o 'UseRoaming no'

Resolution:

解决方案

Security update RHSA-2016-0043 has been released to correct this issue.

已发布的安全更新RHSA-2016-0043可以解决这一问题.


https://access.redhat.com/articles/2123781
http://www.nsfocus.net/vulndb/32265
null
https://lists.centos.org/pipermail/centos-announce/2016-January/021614.html

以下更新过的文件已经被上传并同步到了所有镜像
x86_64:
7aa1a232479f86e7f3b82d335b0683d815ca92f20e14a166a49c03bbb7f8ac9e  openssh-6.6.1p1-23.el7_2.x86_64.rpm
a32b1a4625dd33016d110eb247329be9c242ca78f0b8f8b6d5ec6fc8a3cdc1f0  openssh-askpass-6.6.1p1-23.el7_2.x86_64.rpm
614657ffb529da95ab36aaf3a7f0e72b28622503ab1f7276083bf176b49dd58f  openssh-clients-6.6.1p1-23.el7_2.x86_64.rpm
cc70492e83aa70730a0b885bc00ad645c3ff81c31abcf85a11a06bd8df51895f  openssh-keycat-6.6.1p1-23.el7_2.x86_64.rpm
97ae0347cf1cee17df80c150ff633bfd35d26184f3f9cb1d5b1640af32e9fbeb  openssh-ldap-6.6.1p1-23.el7_2.x86_64.rpm
a5b98159190191c035e260475b6e7fd5a0abeba2babe09749cc2f54748a633dc  openssh-server-6.6.1p1-23.el7_2.x86_64.rpm
7c78c4bcb410d1060463e8bf694f1fe144636042102604a8fbb403e398404b53  openssh-server-sysvinit-6.6.1p1-23.el7_2.x86_64.rpm
93567227a3013b9311dd1669af23e4c2628140c10ce21591ec50afe56b8df8f2  pam_ssh_agent_auth-0.9.3-9.23.el7_2.i686.rpm
c5b9720aec08ee9e853981401dd5946ee4515859d53ec9e86795f7e4403f1db6  pam_ssh_agent_auth-0.9.3-9.23.el7_2.x86_64.rpm

Source:
c0ae36b679f0dd6171897ad8952ec809c968464e685d7a0ae9333ea443132d10  openssh-6.6.1p1-23.el7_2.src.rpm

https://www.sebug.net/vuldb/ssvid-90447

漏洞详情

Although roaming is not supported by the OpenSSH server, it is enabled by default in the OpenSSH client, and contains two vulnerabilities that can be exploited by a malicious SSH server (or a trusted but compromised server): an information leak (memory disclosure), and a buffer overflow (heap-based).

尽管漫游功能不被任何OpenSSH服务端支持, 但他在OpenSSH客户端还是默认开启的. 并且, 它包含了两个可以被恶意SSH服务器利用的漏洞: 一个信息泄露 (内容泄漏), 一个缓冲区溢出 (基于堆)

在OpenSSH客户端的实现中发现了一个信息泄露漏洞. 当使用某些特定版本客户端的默认配置时, 这个漏洞可能 (取决于客户端的版本, 编译器以及操作系统) 导致恶意SSH服务器偷走客户端的私钥. 该信息泄露漏洞已经私下里被经验丰富的攻击者利用过了, 针对知名度高的网站或用户建议重新生成他们的SSH密钥.

The buffer overflow, on the other hand, is present in the default configuration of the OpenSSH client but its exploitation requires two non-default options: a ProxyCommand, and either ForwardAgent (-A) or ForwardX11 (-X). This buffer overflow is therefore unlikely to have any real-world impact, but provides a particularly interesting case study.

另一方面, 缓冲区溢出漏洞出现在OpenSSH客户端的默认配置中. 但利用这一漏洞需要两个非默认设置: 一个是ProxyCommand, 另一个是ForwardAgent (-A) 或ForwardX11 (-X). 因此, 缓冲区溢出可能没有多少现实意义上的影响, 但也提供了一个有趣的案例学习机会.

All OpenSSH versions between 5.4 and 7.1 are vulnerable, but can be easily hot-fixed by setting the undocumented option "UseRoaming" to "no", as detailed in the Mitigating Factors section. OpenSSH version 7.1p2 (released on January 14, 2016) disables roaming by default.

所有处于5.4到7.1版本的OpenSSH都可能收到攻击. 但都能够通过将未文档化的设置"UseRoaming"改为"no"来热修复, 具体方式列在了止损因素章节. OpenSSH 7.1p2 默认禁止了漫游功能.


https://rhn.redhat.com/errata/RHSA-2016-0043.html

Details
详情

An information leak flaw was found in the way the OpenSSH client roaming feature was implemented. A malicious server could potentially use this flaw to leak portions of memory (possibly including private SSH keys) of a successfully authenticated OpenSSH client. (CVE-2016-0777) 

一个恶意服务器可以潜在性地利用这一漏洞对一个成功认证的OpenSSH客户端造成部分内存泄漏 (可能包括私有SSH密钥)

A buffer overflow flaw was found in the way the OpenSSH client roaming feature was implemented. A malicious server could potentially use this flaw to execute arbitrary code on a successfully authenticated OpenSSH client if that client used certain non-default configuration options. (CVE-2016-0778) 

一个恶意服务器可以潜在性地利用这一漏洞在一个没有使用某些非默认设置而又成功认证的OpenSSH客户端上执行任意代码 (可能包括私有SSH密钥)


受影响的产品:
* Red Hat Enterprise Linux Desktop (v. 7)
* Red Hat Enterprise Linux HPC Node (v. 7)
* Red Hat Enterprise Linux Server (v. 7)
* Red Hat Enterprise Linux Workstation (v. 7)









